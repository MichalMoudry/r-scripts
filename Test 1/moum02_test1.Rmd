---
title: "Test 1"
author: "Michal MoudrÃ½"
date: "4/10/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Obsah
- [Definice promÄ›nnÃ½ch a funkcÃ­](#definice-promÄ›nnÃ½ch-a-funkcÃ­)
- [PrvnÃ­ Ãºkol](#prvnÃ­-Ãºkol)
- [DruhÃ½ Ãºkol](#druhÃ½-Ãºkol)
- [TÅ™etÃ­ Ãºkol](#tÅ™etÃ­-Ãºkol)

## Definice promÄ›nnÃ½ch a funkcÃ­
```{r}
osoby <- data.frame(
  "osoba" = 1:30,
  "IQ" = c(94, 75, 93, 91, 88, 79, 88, 84, 92, 90, 97, 100, 82, 86, 110, 96, 90, 92, 92, 99, 96, 103, 97, 88, 93, 90, 85, 86, 96, 86))
rozptyl <- function(hodnoty) {
  return((sum((hodnoty-mean(hodnoty))^2))/(length(hodnoty)))
}
odchylka <- function(hodnoty) {
  return(sqrt((sum((hodnoty-mean(hodnoty))^2))/(length(hodnoty))))
}
var_koef <- function(hodnoty) {
  return((sqrt((sum((hodnoty-mean(hodnoty))^2))/(length(hodnoty))))/mean(hodnoty))
}
tabulkaOsob <- table(osoby$IQ)
tabulkaOsob <- as.data.frame(tabulkaOsob)
colnames(tabulkaOsob) = c("IQ", "Frekvence")
tabulkaOsob$Relativni_cetnost <- tabulkaOsob$Frekvence/sum(tabulkaOsob$Frekvence)
```

## PrvnÃ­ Ãºkol

### a)
Identifikujte, o jakou statistickou promÄ›nnou jde (kvantitativnÃ­ spojitÃ¡, kvantitativnÃ­ nespojitÃ¡, kvalitativnÃ­ nominÃ¡lnÃ­, kvalitativnÃ­ ordinÃ¡lnÃ­).

`OdpovÄ›Ä`: Jde o kvantitativnÃ­ nespojitou (diskrÃ©tnÃ­) statistickou promÄ›nnou.

### b)
S vyuÅ¾itÃ­m vhodnÃ©ho typu grafu vizualizujte hodnoty tohoto statistickÃ©ho znaku.
```{r}
plot(osoby)
```

### c)
VypoÄÃ­tejte [aritmetickÃ½](#aritmetickÃ½-prÅ¯mÄ›r), [harmonickÃ½](#harmonickÃ½-prÅ¯mÄ›r) a [geometrickÃ½ prÅ¯mÄ›r](#geometrickÃ½-prÅ¯mÄ›r) IQ a uveÄte, kterÃ½ z nich se nejlÃ©pe hodÃ­ pro popis prÅ¯mÄ›rnÃ© hodnoty tohoto ukazatele a proÄ.

`OdpovÄ›Ä`: V pÅ™Ã­padÄ› ukazatele IQ je asi nejvhodnÄ›jÅ¡Ã­ harmonickÃ½ prÅ¯mÄ›r, protoÅ¾e danÃ½ prÅ¯mÄ›r je vhodnÃ½ pro sadu ÄÃ­sel, jeÅ¾ majÃ­ vztah k nÄ›jakÃ© jednotce (napÅ™. jednotka Äasu), tedy by se hodil pro popis jednotky inteligenÄnÃ­ho kvocientu.

#### AritmetickÃ½ prÅ¯mÄ›r
```{r}
sum(osoby$IQ)/length(osoby$IQ)
```

#### HarmonickÃ½ prÅ¯mÄ›r
```{r}
length(osoby$IQ)/sum(1/osoby$IQ)
```

#### GeometrickÃ½ prÅ¯mÄ›r
```{r}
exp(mean(log(osoby$IQ)))
```

### d)
VypoÄÃ­tejte dalÅ¡Ã­ charakteristiky polohy: [minimum](#minimum), [maximum](#maximum), [modus](#modus) (pokud existuje), [mediÃ¡n](#mediÃ¡n), [hornÃ­](#hornÃ­-kvartil) a [dolnÃ­ kvartil](#dolnÃ­-kvartil) a vÅ¡echny hodnoty slovnÄ› interpretujte.

#### Minimum
```{r}
min(osoby$IQ)
```
`SlovnÃ­ interpretace`: Hodnota minima statistickÃ©ho znaku IQ je 75, coÅ¾ znamenÃ¡, Å¾e nejmenÅ¡Ã­ hodnota v danÃ©m souboru je 75 IQ.

#### Maximum
```{r}
max(osoby$IQ)
```
`SlovnÃ­ interpretace`: Hodnota maxima statistickÃ©ho znaku IQ je 110, coÅ¾ znamenÃ¡, Å¾e nejvÄ›tÅ¡Ã­ hodnota v danÃ©m souboru je 110 IQ.

#### Modus
```{r}
library(modeest)
mfv(sort(osoby$IQ))
```
`SlovnÃ­ interpretace:` Modus je nejÄastÄ›jÅ¡Ã­ hodnotou v datovÃ©m souboru, tedy v tomto pÅ™Ã­kladÄ› je neÄastÄ›jÅ¡Ã­ hodnota IQ 86, 88, 90, 92, 96 (viz. frekvenÄnÃ­ tabulka) a jelikoÅ¾ to nenÃ­ jedna hodnota, tak modus nemÅ¯Å¾e bÃ½t jednoznaÄnÄ› urÄen.

#### MediÃ¡n
```{r}
median(sort(osoby$IQ))
```
`SlovnÃ­ interpretace`: Hodnota mediÃ¡nu je 91.5, coÅ¾ znamenÃ¡, Å¾e 50% hodnot ve statistickÃ©m souboru jsou menÅ¡Ã­ neÅ¾ 91.5 IQ.

#### HornÃ­ kvartil
```{r}
quantile(osoby$IQ, probs = 0.75)
```
`SlovnÃ­ interpretace`: Hodnota hornÃ­ho kvartilu je 96, coÅ¾ znamenÃ¡, Å¾e 75% hodnot ve statistickÃ©m souboru je menÅ¡Ã­ neÅ¾ 96 IQ.

#### DolnÃ­ kvartil
```{r}
quantile(osoby$IQ, probs = 0.25)
```
`SlovnÃ­ interpretace`: Hodnota dolnÃ­ho kvartilu je 86.5, coÅ¾ znamenÃ¡, Å¾e 25% hodnot ve statistickÃ©m souboru jsou menÅ¡Ã­ neÅ¾ 86.5 IQ.

### e)
VypoÄÃ­tejte mÃ­ry absolutnÃ­ variability: [variaÄnÃ­ rozpÄ›tÃ­](#variaÄnÃ­-rozpÄ›tÃ­), [kvartilovÃ© rozpÄ›tÃ­](#kvartilovÃ©-rozpÄ›tÃ­), [rozptyl](#rozptyl) a [smÄ›rodatnou odchylku](#smÄ›rodatnÃ¡-odchylka) a vÅ¡echny hodnoty slovnÄ› interpretujte.

#### VariaÄnÃ­ rozpÄ›tÃ­
```{r}
max(osoby$IQ) - min(osoby$IQ)
```
`SlovnÃ­ interpretace`: Hodnota variaÄnÃ­ho rozpÄ›tÃ­ je 35, coÅ¾ je hodnota, kterÃ¡ urÄuje vzdÃ¡lenost mezi nejmenÅ¡Ã­ a nejvÄ›tÅ¡Ã­ hodnotou v datasetu, tedy v tomto pÅ™Ã­padÄ› mezi hodnotou 110 a 75.

#### KvartilovÃ© rozpÄ›tÃ­
```{r}
quantile(osoby$IQ, probs = 0.75) - quantile(osoby$IQ, probs = 0.25)
```
`SlovnÃ­ interpretace`: Hodnota kvartilovÃ©ho rozpÄ›tÃ­ je 9.5, coÅ¾ je hodnota, kterÃ¡ oznaÄuje rozdÃ­l mezi hornÃ­m a dolnÃ­m kvartilem, tedy v tomto pÅ™Ã­padÄ› mezi hodnotami 96 a 86.5.

#### Rozptyl
```{r}
rozptyl(osoby$IQ)
```
`SlovnÃ­ interpretace`: Hodnota rozptylu je 49.52889, pÅ™iÄemÅ¾ tato hodnota udÃ¡vÃ¡ variablitu ve statistickÃ©m souboru.

#### SmÄ›rodatnÃ¡ odchylka
```{r}
odchylka(osoby$IQ)
```
`SlovnÃ­ interpretace`: Hodnota smÄ›rodatnÃ© odchylky je 7.037676, coÅ¾ je hodnota zÃ­skanÃ¡ odmocnÄ›nÃ­m rozptylu a vypovÃ­dÃ¡ o tom, nakolik se od sebe liÅ¡Ã­ jednotlivÃ© prvky v souboru.

### f)
VypoÄÃ­tejte mÃ­ru relativnÃ­ variability: [variaÄnÃ­ koeficient](#variaÄnÃ­-koeficient) a danou hodnotu slovnÄ› interpretujte.

`PoznÃ¡mka`: Tady jsem myslel, Å¾e mÃ¡m mÃ­ru variablity spoÄÃ­tat pomocÃ­ rozptylu z relativnÃ­ Äetnosti (nevÄ›dÄ›l jsem, Å¾e mi vyjde stejnÃ½ vÃ½sledek jako u rozptylu), ale rozhodl jsem se to tu nechat

#### Rozptyl z relativnÃ­ Äetnosti
```{r}
tabulkaCetnostiIQ <- as.data.frame(as.numeric(levels(tabulkaOsob$IQ)))
colnames(tabulkaCetnostiIQ) = c("IQ");
rozptyl_z_rel_cetnosti <- sum(((tabulkaCetnostiIQ$IQ - mean(tabulkaCetnostiIQ$IQ))^2)*tabulkaOsob$Relativni_cetnost)
rozptyl_z_rel_cetnosti
```

#### VariaÄnÃ­ koeficient
```{r}
sqrt(rozptyl_z_rel_cetnosti)/mean(osoby$IQ)
```
`SlovnÃ­ interpretace`: VariaÄnÃ­ koeficient se pouÅ¾Ã­vÃ¡ pro porovnÃ¡nÃ­ variablity mezi dvÄ›mi datasety, je to tedy hodnota vyjadÅ™ujÃ­cÃ­ pomÄ›r mezi smÄ›rodatnou odchylkou a prÅ¯mÄ›rnou hodnotou statistickÃ©ho znaku v souboru.

### g)
OdpovÃ­dÃ¡ podle VÃ¡s analyzovanÃ¡ promÄ›nnÃ¡ IQ normÃ¡lnÃ­mu rozdÄ›lenÃ­? UveÄte argumenty, kterÃ© podporujÃ­ VaÅ¡e rozhodnutÃ­.

`OdpovÄ›Ä`: Ano, z vÄ›tÅ¡Ã­ ÄÃ¡sti odpovÃ­dÃ¡ kÅ™ivce hustoty normÃ¡lnÃ­ho rozdÄ›lenÃ­, tedy nejmÃ©nÄ› hodnot je na zaÄÃ¡tku, na konci a nÄ›jvÄ›tÅ¡Ã­ poÄet hodnot je kolem stÅ™edu (prÅ¯mÄ›ru). Danou skuteÄnost lze vidÄ›t na histogramu IQ osob v souboru.

```{r}
hist(osoby$IQ)
```

## DruhÃ½ Ãºkol
JakÃ¡ je pravdÄ›podobnost, Å¾e z 9 kol losovÃ¡nÃ­ rulety obdrÅ¾Ã­me:

a) [6-krÃ¡t ÄÃ­slo ÄervenÃ© barvy](#a-6-krÃ¡t-ÄÃ­slo-ÄervenÃ©-barvy)
b) [8-krÃ¡t lichÃ© ÄÃ­slo](#b-8-krÃ¡t-lichÃ©-ÄÃ­slo)
c) [maximÃ¡lnÄ› 4-krÃ¡t ÄÃ­slo dÄ›litelnÃ© 4](#c-maximÃ¡lnÄ›-4-krÃ¡t-ÄÃ­slo-dÄ›litelnÃ©-4)
d) [alespoÅˆ 8-krÃ¡t ÄÃ­slo vÄ›tÅ¡Ã­ neÅ¾ 7](#d-alespoÅˆ-8-krÃ¡t-ÄÃ­slo-vÄ›tÅ¡Ã­-neÅ¾-7)

V tomto cviÄenÃ­ jsem pouÅ¾il vzorce binomockÃ©ho rozdÄ›lenÃ­, tedy pro vÃ½poÄet pravdÄ›podobnostnÃ­ funkce jsem pouÅ¾il funkci dbinom a pro vÃ½poÄet distribuÄnÃ­ funkce jsem pouÅ¾il pbinom.

### a) 6-krÃ¡t ÄÃ­slo ÄervenÃ© barvy
x = 6 ... oznaÄuje kolikrÃ¡t mÃ¡ padnout ÄervenÃ¡ barva

n (size) = 9 ... poÄet pokusÅ¯

prob = poÄet ÄervenÃ½ch ÄÃ­sel / poÄtem vÅ¡ech ÄÃ­sel (vÄetnÄ› nuly) = choose(18, 1) / choose(37, 1) = 18 / 37
```{r}
dbinom(x = 6, size = 9, prob = 18 / 37)
```

`SlovnÃ­ odpovÄ›Ä`: PravdÄ›podobnost, Å¾e z 9 kol losovÃ¡nÃ­ rulety obdrÅ¾Ã­me 6-krÃ¡t ÄÃ­slo ÄervenÃ© barvy je pÅ™ibliÅ¾nÄ› 15,1 %.

### b) 8-krÃ¡t lichÃ© ÄÃ­slo
x = 8 ... oznaÄuje kolikrÃ¡t mÃ¡ padnout lichÃ© ÄÃ­slo

n (size) = 9 ... poÄet pokusÅ¯

prob = poÄet lichÃ½ch ÄÃ­sel / poÄtem vÅ¡ech ÄÃ­sel (vÄetnÄ› nuly) = choose(18, 1) / choose(37, 1) = 18 / 37
```{r}
dbinom(x = 8, size = 9, prob = 18 / 37)
```

`SlovnÃ­ odpovÄ›Ä`: PravdÄ›podobnost, Å¾e z 9 kol losovÃ¡nÃ­ rulety obdrÅ¾Ã­me 8-krÃ¡t lichÃ© ÄÃ­slo je pÅ™ibliÅ¾nÄ› 1,5 %.

### c) maximÃ¡lnÄ› 4-krÃ¡t ÄÃ­slo dÄ›litelnÃ© 4
q = 4 ... oznaÄuje kolikrÃ¡t maximÃ¡lnÄ› mÃ¡ padnout ÄÃ­slo dÄ›litelnÃ© 4

n (size) = 9 ... poÄet pokusÅ¯

prob = poÄet ÄÃ­sel dÄ›litelnÃ½ch 4 / poÄtem vÅ¡ech ÄÃ­sel (vÄetnÄ› nuly) = choose(9, 1) / choose(37, 1) = 9 / 37
```{r}
pbinom(q = 4, size = 9, prob = 9 / 37)
```

`SlovnÃ­ odpovÄ›Ä`: PravdÄ›podobnost, Å¾e z 9 kol losovÃ¡nÃ­ rulety obdrÅ¾Ã­me maximÃ¡lnÄ› 4-krÃ¡t ÄÃ­slo dÄ›litelnÃ© 4 je pÅ™ibliÅ¾nÄ› 95,6 %.

### d) alespoÅˆ 8-krÃ¡t ÄÃ­slo vÄ›tÅ¡Ã­ neÅ¾ 7
poÄet ÄÃ­sel vÄ›tÅ¡Ã­ch neÅ¾ 7 = 29

q = 8 ... oznaÄuje kolikrÃ¡t mÃ¡ padnout ÄÃ­slo vÄ›tÅ¡Ã­ neÅ¾ 7 (>=)

n (size) = 9 ... poÄet pokusÅ¯

`VÃ½poÄet`: P(A >= 8) = 1 - F(A < 8) = 1 - pravdÄ›podobnost, Å¾e alespoÅˆ padne ÄÃ­slo menÅ¡Ã­ neÅ¾ nebo rovno 7
```{r}
1 - pbinom(q = 8, size = 9, prob = 29 / 37)
```

`SlovnÃ­ odpovÄ›Ä`: PravdÄ›podobnost, Å¾e z 9 kol losovÃ¡nÃ­ rulety obdrÅ¾Ã­me alespoÅˆ 8-krÃ¡t ÄÃ­slo vÄ›tÅ¡Ã­ neÅ¾ 7 je pÅ™ibliÅ¾nÄ› 11,2 %.

## TÅ™etÃ­ Ãºkol
VÃ½sledek mÄ›Å™enÃ­ proudu je nÃ¡hodnÃ¡ veliÄina X s normÃ¡lnÃ­m rozdÄ›lenÃ­m se stÅ™ednÃ­ hodnotou ğœ‡ = 10 mA a smÄ›rodatnou odchylkou ğœ = 2 mA. VypoÄÃ­tejte pravdÄ›podobnost, Å¾e pÅ™i nÃ¡hodnÃ©m mÄ›Å™enÃ­ bude namÄ›Å™eno:

a) [mÃ©nÄ› neÅ¾ 14 mA](#a-mÃ©nÄ›-neÅ¾-14-ma)
b) [vÃ­ce neÅ¾ 6 mA](#b-vÃ­ce-neÅ¾-6-ma)
c) [vÃ­ce neÅ¾ 6 mA a mÃ©nÄ› neÅ¾ 14 mA](#c-vÃ­ce-neÅ¾-6-ma-a-mÃ©nÄ›-neÅ¾-14-ma)
d) [jakou hodnotu v mA pÅ™ekroÄÃ­ 85 % mÄ›Å™enÃ­](#d-jakou-hodnotu-v-ma-pÅ™ekroÄÃ­-85-mÄ›Å™enÃ­)


V rÃ¡mci tohoto cviÄenÃ­ jsem pouÅ¾il vzorce normÃ¡lnÃ­ho rozdÄ›lenÃ­ a to konkrÃ©tnÄ› pro vÃ½poÄet distribuÄnÃ­ funkce (pnorm) a qnorm pro vyhlednÃ¡nÃ­ hodnot z tabulek.

### a) mÃ©nÄ› neÅ¾ 14 mA
`PoznÃ¡mka`: Z hodin elektrotechniky si toho moc nepamatuji, ale nemyslÃ­m si, Å¾e proud by mohl jÃ­t do zÃ¡poru, coÅ¾ by odpovÃ­dalo koncepci Gaussovy diody, proto jsem zvolil rozmezÃ­ <0;13>

q2 ... hornÃ­ hodnota rozmezÃ­ (chceme hodnoty menÅ¡Ã­ neÅ¾ 14 mA proto je q2 rovno 13) = 13

q1 ... dolnÃ­ hodnota rozmezÃ­ (minimÃ¡lnÃ­ namÄ›Å™enÃ½ proud) = 0

mean ... stÅ™ednÃ­ hodnota = 10

sd ... smÄ›rodatnÃ¡ odchylka = 2
```{r}
pnorm(q = 13, mean = 10, sd = 2) - pnorm(q = 0, mean = 10, sd = 2)
# pnorm(q = 0, mean = 10, sd = 2) ... pÅ™estoÅ¾e se nejednÃ¡ o velkÃ© ÄÃ­slo, tak dle mÃ© poznÃ¡mky by se mÄ›lo odeÄÃ­st.
```

`SlovnÃ­ interpretace`: PravdÄ›podobnost, Å¾e namÄ›Å™Ã­me proud menÅ¡Ã­ neÅ¾ 14 mA je 93,3 %.

### b) vÃ­ce neÅ¾ 6 mA
q ... dolnÃ­ hodnota rozmezÃ­ (je tÅ™eba vÃ­ce neÅ¾ 6, proto q = 7)

mean ... stÅ™ednÃ­ hodnota = 10

sd ... smÄ›rodatnÃ¡ odchylka = 2
```{r}
pnorm(q = 6, mean = 10, sd = 2, lower.tail = FALSE)
```

`SlovnÃ­ interpretace`: PravdÄ›podobnost, Å¾e namÄ›Å™Ã­me proud vÄ›tÅ¡Ã­ neÅ¾ 6 mA je pÅ™ibliÅ¾nÄ› 97,7 %.

### c) vÃ­ce neÅ¾ 6 mA a mÃ©nÄ› neÅ¾ 14 mA

q1 ... dolnÃ­ hodnota rozmezÃ­ = 7

q2 ... hornÃ­ hodnota rozmezÃ­ = 13

mean ... stÅ™ednÃ­ hodnota = 10

sd = smÄ›rodatnÃ¡ odchylka = 2
```{r}
pnorm(q = 13, mean = 10, sd = 2) - pnorm(q = 7, mean = 10, sd = 2)
```

`SlovnÃ­ interpretace`: PravdÄ›podobnost, Å¾e namÄ›Å™Ã­me proud v rozmezÃ­ 6 mA a 14 mA je 86,6 %.

### d) jakou hodnotu v mA pÅ™ekroÄÃ­ 85 % mÄ›Å™enÃ­

VÃ½poÄet 85 % kvantilu - x0,85

x0,85 = u0,85 * ğœ + ğœ‡

u0,85 = 1.036433

ğœ = 2

ğœ‡ = 10

x0,85 = 1.036433 * 2 + 10 = 12.07287

```{r}
qnorm(p = 0.85, mean = 0, sd = 1)
x0.85 <- qnorm(p = 0.85, mean = 0, sd = 1) * 2 + 10
x0.85
```

`SlovnÃ­ interpretace`: PÅ™i pÅ™ibliÅ¾nÃ© hodnotÄ› 12,1 mA je pÅ™ekroÄeno 85 % mÄ›Å™enÃ­.