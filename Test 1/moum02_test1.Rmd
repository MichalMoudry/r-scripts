---
title: "Test 1"
author: "Michal Moudr√Ω"
date: "4/10/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Obsah
- [Definice promƒõnn√Ωch a funkc√≠](#definice-promƒõnn√Ωch-a-funkc√≠)
- [Prvn√≠ √∫kol](#prvn√≠-√∫kol)
- [Druh√Ω √∫kol](#druh√Ω-√∫kol)
- [T≈ôet√≠ √∫kol](#t≈ôet√≠-√∫kol)

## Definice promƒõnn√Ωch a funkc√≠
```{r}
osoby <- data.frame(
  "osoba" = 1:30,
  "IQ" = c(94, 75, 93, 91, 88, 79, 88, 84, 92, 90, 97, 100, 82, 86, 110, 96, 90, 92, 92, 99, 96, 103, 97, 88, 93, 90, 85, 86, 96, 86))
rozptyl <- function(hodnoty) {
  return((sum((hodnoty-mean(hodnoty))^2))/(length(hodnoty)))
}
odchylka <- function(hodnoty) {
  return(sqrt((sum((hodnoty-mean(hodnoty))^2))/(length(hodnoty))))
}
var_koef <- function(hodnoty) {
  return((sqrt((sum((hodnoty-mean(hodnoty))^2))/(length(hodnoty))))/mean(hodnoty))
}
tabulkaOsob <- table(osoby$IQ)
tabulkaOsob <- as.data.frame(tabulkaOsob)
colnames(tabulkaOsob) = c("IQ", "Frekvence")
tabulkaOsob$Relativni_cetnost <- tabulkaOsob$Frekvence/sum(tabulkaOsob$Frekvence)
```

## Prvn√≠ √∫kol

### a)
Identifikujte, o jakou statistickou promƒõnnou jde (kvantitativn√≠ spojit√°, kvantitativn√≠ nespojit√°, kvalitativn√≠ nomin√°ln√≠, kvalitativn√≠ ordin√°ln√≠).

`Odpovƒõƒè`: Jde o kvantitativn√≠ nespojitou (diskr√©tn√≠) statistickou promƒõnnou.

### b)
S vyu≈æit√≠m vhodn√©ho typu grafu vizualizujte hodnoty tohoto statistick√©ho znaku.
```{r}
plot(osoby)
```

### c)
Vypoƒç√≠tejte [aritmetick√Ω](#aritmetick√Ω-pr≈Ømƒõr), [harmonick√Ω](#harmonick√Ω-pr≈Ømƒõr) a [geometrick√Ω pr≈Ømƒõr](#geometrick√Ω-pr≈Ømƒõr) IQ a uveƒète, kter√Ω z nich se nejl√©pe hod√≠ pro popis pr≈Ømƒõrn√© hodnoty tohoto ukazatele a proƒç.

`Odpovƒõƒè`: V p≈ô√≠padƒõ ukazatele IQ je asi nejvhodnƒõj≈°√≠ harmonick√Ω pr≈Ømƒõr, proto≈æe dan√Ω pr≈Ømƒõr je vhodn√Ω pro sadu ƒç√≠sel, je≈æ maj√≠ vztah k nƒõjak√© jednotce (nap≈ô. jednotka ƒçasu), tedy by se hodil pro popis jednotky inteligenƒçn√≠ho kvocientu.

#### Aritmetick√Ω pr≈Ømƒõr
```{r}
sum(osoby$IQ)/length(osoby$IQ)
```

#### Harmonick√Ω pr≈Ømƒõr
```{r}
length(osoby$IQ)/sum(1/osoby$IQ)
```

#### Geometrick√Ω pr≈Ømƒõr
```{r}
exp(mean(log(osoby$IQ)))
```

### d)
Vypoƒç√≠tejte dal≈°√≠ charakteristiky polohy: [minimum](#minimum), [maximum](#maximum), [modus](#modus) (pokud existuje), [medi√°n](#medi√°n), [horn√≠](#horn√≠-kvartil) a [doln√≠ kvartil](#doln√≠-kvartil) a v≈°echny hodnoty slovnƒõ interpretujte.

#### Minimum
```{r}
min(osoby$IQ)
```
`Slovn√≠ interpretace`: Hodnota minima statistick√©ho znaku IQ je 75, co≈æ znamen√°, ≈æe nejmen≈°√≠ hodnota v dan√©m souboru je 75 IQ.

#### Maximum
```{r}
max(osoby$IQ)
```
`Slovn√≠ interpretace`: Hodnota maxima statistick√©ho znaku IQ je 110, co≈æ znamen√°, ≈æe nejvƒõt≈°√≠ hodnota v dan√©m souboru je 110 IQ.

#### Modus
```{r}
library(modeest)
mfv(sort(osoby$IQ))
```
`Slovn√≠ interpretace:` Modus je nejƒçastƒõj≈°√≠ hodnotou v datov√©m souboru, tedy v tomto p≈ô√≠kladƒõ je neƒçastƒõj≈°√≠ hodnota IQ 86, 88, 90, 92, 96 (viz. frekvenƒçn√≠ tabulka) a jeliko≈æ to nen√≠ jedna hodnota, tak modus nem≈Ø≈æe b√Ωt jednoznaƒçnƒõ urƒçen.

#### Medi√°n
```{r}
median(sort(osoby$IQ))
```
`Slovn√≠ interpretace`: Hodnota medi√°nu je 91.5, co≈æ znamen√°, ≈æe 50% hodnot ve statistick√©m souboru jsou men≈°√≠ ne≈æ 91.5 IQ.

#### Horn√≠ kvartil
```{r}
quantile(osoby$IQ, probs = 0.75)
```
`Slovn√≠ interpretace`: Hodnota horn√≠ho kvartilu je 96, co≈æ znamen√°, ≈æe 75% hodnot ve statistick√©m souboru je men≈°√≠ ne≈æ 96 IQ.

#### Doln√≠ kvartil
```{r}
quantile(osoby$IQ, probs = 0.25)
```
`Slovn√≠ interpretace`: Hodnota doln√≠ho kvartilu je 86.5, co≈æ znamen√°, ≈æe 25% hodnot ve statistick√©m souboru jsou men≈°√≠ ne≈æ 86.5 IQ.

### e)
Vypoƒç√≠tejte m√≠ry absolutn√≠ variability: [variaƒçn√≠ rozpƒõt√≠](#variaƒçn√≠-rozpƒõt√≠), [kvartilov√© rozpƒõt√≠](#kvartilov√©-rozpƒõt√≠), [rozptyl](#rozptyl) a [smƒõrodatnou odchylku](#smƒõrodatn√°-odchylka) a v≈°echny hodnoty slovnƒõ interpretujte.

#### Variaƒçn√≠ rozpƒõt√≠
```{r}
max(osoby$IQ) - min(osoby$IQ)
```
`Slovn√≠ interpretace`: Hodnota variaƒçn√≠ho rozpƒõt√≠ je 35, co≈æ je hodnota, kter√° urƒçuje vzd√°lenost mezi nejmen≈°√≠ a nejvƒõt≈°√≠ hodnotou v datasetu, tedy v tomto p≈ô√≠padƒõ mezi hodnotou 110 a 75.

#### Kvartilov√© rozpƒõt√≠
```{r}
quantile(osoby$IQ, probs = 0.75) - quantile(osoby$IQ, probs = 0.25)
```
`Slovn√≠ interpretace`: Hodnota kvartilov√©ho rozpƒõt√≠ je 9.5, co≈æ je hodnota, kter√° oznaƒçuje rozd√≠l mezi horn√≠m a doln√≠m kvartilem, tedy v tomto p≈ô√≠padƒõ mezi hodnotami 96 a 86.5.

#### Rozptyl
```{r}
rozptyl(osoby$IQ)
```
`Slovn√≠ interpretace`: Hodnota rozptylu je 49.52889, p≈ôiƒçem≈æ tato hodnota ud√°v√° variablitu ve statistick√©m souboru.

#### Smƒõrodatn√° odchylka
```{r}
odchylka(osoby$IQ)
```
`Slovn√≠ interpretace`: Hodnota smƒõrodatn√© odchylky je 7.037676, co≈æ je hodnota z√≠skan√° odmocnƒõn√≠m rozptylu a vypov√≠d√° o tom, nakolik se od sebe li≈°√≠ jednotliv√© prvky v souboru.

### f)
Vypoƒç√≠tejte m√≠ru relativn√≠ variability: [variaƒçn√≠ koeficient](#variaƒçn√≠-koeficient) a danou hodnotu slovnƒõ interpretujte.

`Pozn√°mka`: Tady jsem myslel, ≈æe m√°m m√≠ru variablity spoƒç√≠tat pomoc√≠ rozptylu z relativn√≠ ƒçetnosti (nevƒõdƒõl jsem, ≈æe mi vyjde stejn√Ω v√Ωsledek jako u rozptylu), ale rozhodl jsem se to tu nechat

#### Rozptyl z relativn√≠ ƒçetnosti
```{r}
tabulkaCetnostiIQ <- as.data.frame(as.numeric(levels(tabulkaOsob$IQ)))
colnames(tabulkaCetnostiIQ) = c("IQ");
rozptyl_z_rel_cetnosti <- sum(((tabulkaCetnostiIQ$IQ - mean(tabulkaCetnostiIQ$IQ))^2)*tabulkaOsob$Relativni_cetnost)
rozptyl_z_rel_cetnosti
```

#### Variaƒçn√≠ koeficient
```{r}
sqrt(rozptyl_z_rel_cetnosti)/mean(osoby$IQ)
```
`Slovn√≠ interpretace`: Variaƒçn√≠ koeficient se pou≈æ√≠v√° pro porovn√°n√≠ variablity mezi dvƒõmi datasety, je to tedy hodnota vyjad≈ôuj√≠c√≠ pomƒõr mezi smƒõrodatnou odchylkou a pr≈Ømƒõrnou hodnotou statistick√©ho znaku v souboru.

### g)
Odpov√≠d√° podle V√°s analyzovan√° promƒõnn√° IQ norm√°ln√≠mu rozdƒõlen√≠? Uveƒète argumenty, kter√© podporuj√≠ Va≈°e rozhodnut√≠.

`Odpovƒõƒè`: Ano, z vƒõt≈°√≠ ƒç√°sti odpov√≠d√° k≈ôivce hustoty norm√°ln√≠ho rozdƒõlen√≠, tedy nejm√©nƒõ hodnot je na zaƒç√°tku, na konci a nƒõjvƒõt≈°√≠ poƒçet hodnot je kolem st≈ôedu (pr≈Ømƒõru). Danou skuteƒçnost lze vidƒõt na histogramu IQ osob v souboru.

```{r}
hist(osoby$IQ)
```

## Druh√Ω √∫kol
Jak√° je pravdƒõpodobnost, ≈æe z 9 kol losov√°n√≠ rulety obdr≈æ√≠me:

a) [6-kr√°t ƒç√≠slo ƒçerven√© barvy](#a-6-kr√°t-ƒç√≠slo-ƒçerven√©-barvy)
b) [8-kr√°t lich√© ƒç√≠slo](#b-8-kr√°t-lich√©-ƒç√≠slo)
c) [maxim√°lnƒõ 4-kr√°t ƒç√≠slo dƒõliteln√© 4](#c-maxim√°lnƒõ-4-kr√°t-ƒç√≠slo-dƒõliteln√©-4)
d) [alespo≈à 8-kr√°t ƒç√≠slo vƒõt≈°√≠ ne≈æ 7](#d-alespo≈à-8-kr√°t-ƒç√≠slo-vƒõt≈°√≠-ne≈æ-7)

V tomto cviƒçen√≠ jsem pou≈æil vzorce binomock√©ho rozdƒõlen√≠, tedy pro v√Ωpoƒçet pravdƒõpodobnostn√≠ funkce jsem pou≈æil funkci dbinom a pro v√Ωpoƒçet distribuƒçn√≠ funkce jsem pou≈æil pbinom.

### a) 6-kr√°t ƒç√≠slo ƒçerven√© barvy
x = 6 ... oznaƒçuje kolikr√°t m√° padnout ƒçerven√° barva

n (size) = 9 ... poƒçet pokus≈Ø

prob = poƒçet ƒçerven√Ωch ƒç√≠sel / poƒçtem v≈°ech ƒç√≠sel (vƒçetnƒõ nuly) = choose(18, 1) / choose(37, 1) = 18 / 37
```{r}
dbinom(x = 6, size = 9, prob = 18 / 37)
```

`Slovn√≠ odpovƒõƒè`: Pravdƒõpodobnost, ≈æe z 9 kol losov√°n√≠ rulety obdr≈æ√≠me 6-kr√°t ƒç√≠slo ƒçerven√© barvy je p≈ôibli≈ænƒõ 15,1 %.

### b) 8-kr√°t lich√© ƒç√≠slo
x = 8 ... oznaƒçuje kolikr√°t m√° padnout lich√© ƒç√≠slo

n (size) = 9 ... poƒçet pokus≈Ø

prob = poƒçet lich√Ωch ƒç√≠sel / poƒçtem v≈°ech ƒç√≠sel (vƒçetnƒõ nuly) = choose(18, 1) / choose(37, 1) = 18 / 37
```{r}
dbinom(x = 8, size = 9, prob = 18 / 37)
```

`Slovn√≠ odpovƒõƒè`: Pravdƒõpodobnost, ≈æe z 9 kol losov√°n√≠ rulety obdr≈æ√≠me 8-kr√°t lich√© ƒç√≠slo je p≈ôibli≈ænƒõ 1,5 %.

### c) maxim√°lnƒõ 4-kr√°t ƒç√≠slo dƒõliteln√© 4
q = 4 ... oznaƒçuje kolikr√°t maxim√°lnƒõ m√° padnout ƒç√≠slo dƒõliteln√© 4

n (size) = 9 ... poƒçet pokus≈Ø

prob = poƒçet ƒç√≠sel dƒõliteln√Ωch 4 / poƒçtem v≈°ech ƒç√≠sel (vƒçetnƒõ nuly) = choose(9, 1) / choose(37, 1) = 9 / 37
```{r}
pbinom(q = 4, size = 9, prob = 9 / 37)
```

`Slovn√≠ odpovƒõƒè`: Pravdƒõpodobnost, ≈æe z 9 kol losov√°n√≠ rulety obdr≈æ√≠me maxim√°lnƒõ 4-kr√°t ƒç√≠slo dƒõliteln√© 4 je p≈ôibli≈ænƒõ 95,6 %.

### d) alespo≈à 8-kr√°t ƒç√≠slo vƒõt≈°√≠ ne≈æ 7
poƒçet ƒç√≠sel vƒõt≈°√≠ch ne≈æ 7 = 29

q = 8 ... oznaƒçuje kolikr√°t m√° padnout ƒç√≠slo vƒõt≈°√≠ ne≈æ 7 (>=)

n (size) = 9 ... poƒçet pokus≈Ø

`V√Ωpoƒçet`: P(A >= 8) = 1 - F(A < 8) = 1 - pravdƒõpodobnost, ≈æe alespo≈à padne ƒç√≠slo men≈°√≠ ne≈æ nebo rovno 7
```{r}
1 - pbinom(q = 8, size = 9, prob = 29 / 37)
```

`Slovn√≠ odpovƒõƒè`: Pravdƒõpodobnost, ≈æe z 9 kol losov√°n√≠ rulety obdr≈æ√≠me alespo≈à 8-kr√°t ƒç√≠slo vƒõt≈°√≠ ne≈æ 7 je p≈ôibli≈ænƒõ 11,2 %.

## T≈ôet√≠ √∫kol
V√Ωsledek mƒõ≈ôen√≠ proudu je n√°hodn√° veliƒçina X s norm√°ln√≠m rozdƒõlen√≠m se st≈ôedn√≠ hodnotou ùúá = 10 mA a smƒõrodatnou odchylkou ùúé = 2 mA. Vypoƒç√≠tejte pravdƒõpodobnost, ≈æe p≈ôi n√°hodn√©m mƒõ≈ôen√≠ bude namƒõ≈ôeno:

a) [m√©nƒõ ne≈æ 14 mA](#a-m√©nƒõ-ne≈æ-14-ma)
b) [v√≠ce ne≈æ 6 mA](#b-v√≠ce-ne≈æ-6-ma)
c) [v√≠ce ne≈æ 6 mA a m√©nƒõ ne≈æ 14 mA](#c-v√≠ce-ne≈æ-6-ma-a-m√©nƒõ-ne≈æ-14-ma)
d) [jakou hodnotu v mA p≈ôekroƒç√≠ 85 % mƒõ≈ôen√≠](#d-jakou-hodnotu-v-ma-p≈ôekroƒç√≠-85-mƒõ≈ôen√≠)


V r√°mci tohoto cviƒçen√≠ jsem pou≈æil vzorce norm√°ln√≠ho rozdƒõlen√≠ a to konkr√©tnƒõ pro v√Ωpoƒçet distribuƒçn√≠ funkce (pnorm) a qnorm pro vyhledn√°n√≠ hodnot z tabulek.

### a) m√©nƒõ ne≈æ 14 mA
`Pozn√°mka`: Z hodin elektrotechniky si toho moc nepamatuji, ale nemysl√≠m si, ≈æe proud by mohl j√≠t do z√°poru, co≈æ by odpov√≠dalo koncepci Gaussovy diody, proto jsem zvolil rozmez√≠ <0;13>

q2 ... horn√≠ hodnota rozmez√≠ (chceme hodnoty men≈°√≠ ne≈æ 14 mA proto je q2 rovno 13) = 13

q1 ... doln√≠ hodnota rozmez√≠ (minim√°ln√≠ namƒõ≈ôen√Ω proud) = 0

mean ... st≈ôedn√≠ hodnota = 10

sd ... smƒõrodatn√° odchylka = 2
```{r}
pnorm(q = 13, mean = 10, sd = 2) - pnorm(q = 0, mean = 10, sd = 2)
# pnorm(q = 0, mean = 10, sd = 2) ... p≈ôesto≈æe se nejedn√° o velk√© ƒç√≠slo, tak dle m√© pozn√°mky by se mƒõlo odeƒç√≠st.
```

`Slovn√≠ interpretace`: Pravdƒõpodobnost, ≈æe namƒõ≈ô√≠me proud men≈°√≠ ne≈æ 14 mA je 93,3 %.

### b) v√≠ce ne≈æ 6 mA
q ... doln√≠ hodnota rozmez√≠ (je t≈ôeba v√≠ce ne≈æ 6, proto q = 7)

mean ... st≈ôedn√≠ hodnota = 10

sd ... smƒõrodatn√° odchylka = 2
```{r}
pnorm(q = 6, mean = 10, sd = 2, lower.tail = FALSE)
```

`Slovn√≠ interpretace`: Pravdƒõpodobnost, ≈æe namƒõ≈ô√≠me proud vƒõt≈°√≠ ne≈æ 6 mA je p≈ôibli≈ænƒõ 97,7 %.

### c) v√≠ce ne≈æ 6 mA a m√©nƒõ ne≈æ 14 mA

q1 ... doln√≠ hodnota rozmez√≠ = 7

q2 ... horn√≠ hodnota rozmez√≠ = 13

mean ... st≈ôedn√≠ hodnota = 10

sd = smƒõrodatn√° odchylka = 2
```{r}
pnorm(q = 13, mean = 10, sd = 2) - pnorm(q = 7, mean = 10, sd = 2)
```

`Slovn√≠ interpretace`: Pravdƒõpodobnost, ≈æe namƒõ≈ô√≠me proud v rozmez√≠ 6 mA a 14 mA je 86,6 %.

### d) jakou hodnotu v mA p≈ôekroƒç√≠ 85 % mƒõ≈ôen√≠

V√Ωpoƒçet 85 % kvantilu - x0,85

x0,85 = u0,85 * ùúé + ùúá

u0,85 = 1.036433

ùúé = 2

ùúá = 10

x0,85 = 1.036433 * 2 + 10 = 12.07287

```{r}
qnorm(p = 0.85, mean = 0, sd = 1)
x0.85 <- qnorm(p = 0.85, mean = 0, sd = 1) * 2 + 10
x0.85
```

`Slovn√≠ interpretace`: P≈ôi p≈ôibli≈æn√© hodnotƒõ 12,1 mA je p≈ôekroƒçeno 85 % mƒõ≈ôen√≠.